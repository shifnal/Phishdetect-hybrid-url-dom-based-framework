<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="/favicon.ico" />
<title>PhishDetect</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        cyber: {
          primary: '#7f00ff',
          accent: '#00f2ff',
          success: '#00ff9d',
          danger: '#ff0055'
        }
      }
    }
  }
}
</script>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">

<style>
body { background: radial-gradient(circle at top left, #120c2e, #070b14 60%); }
.glass { background: rgba(255,255,255,0.08); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.15); }
.progress-container { height: 14px; background: rgba(255,255,255,0.15); border-radius: 9999px; overflow: hidden; }
.progress-bar { height: 100%; width: 0%; transition: width 1s ease; border-radius: 9999px; }
#urlScore { background: linear-gradient(90deg,#00f2ff,#7f00ff); }
#domScore { background: linear-gradient(90deg,#7f00ff,#ff7d00); }
#visualScore { background: linear-gradient(90deg,#ff7d00,#00f2ff); }
#hybridScore { background: linear-gradient(90deg,#00ff9d,#00f2ff); }
.text-legit { color:#00ff9d; }
.text-phish { color:#ff0055; }
</style>
</head>

<body class="text-slate-100 font-['Inter'] min-h-screen">

<header class="pt-14 pb-10 text-center">
  <h1 class="text-5xl font-black text-cyber-primary">PhishDetect</h1>
  <p class="text-slate-400 mt-2">
    Hybrid URL – DOM – Visual Phishing Detection Framework
  </p>
</header>

<main class="max-w-6xl mx-auto px-6">

<form id="urlForm" class="glass flex gap-4 p-4 rounded-2xl mb-14">
  <input id="url" type="url" required
    class="flex-grow bg-transparent outline-none text-lg px-4"
    placeholder="https://secure-login-portal.com">
  <button id="analyzeBtn"
    class="px-8 py-3 bg-cyber-accent text-black font-bold rounded-xl">
    Analyze
  </button>
</form>

<section id="results" class="space-y-10 hidden">

<!-- Brand -->
<div class="text-center">
  <span class="px-6 py-2 glass rounded-full text-sm">
    Detected Brand: <b id="detectedBrand">—</b>
  </span>
</div>

<!-- Scores -->
<div class="grid md:grid-cols-4 gap-6">

<div class="glass p-5 rounded-2xl">
  <h3 class="font-semibold mb-1">URL Analysis</h3>
  <p class="text-xs text-slate-400 mb-2">Lexical & ML-based URL risk</p>
  <div class="progress-container"><div id="urlScore" class="progress-bar"></div></div>
  <p class="mt-2 text-center font-bold" id="urlValue">0%</p>
</div>

<div class="glass p-5 rounded-2xl">
  <h3 class="font-semibold mb-1">DOM Similarity</h3>
  <p class="text-xs text-slate-400 mb-2">Structure & tag comparison</p>
  <div class="progress-container"><div id="domScore" class="progress-bar"></div></div>
  <p class="mt-2 text-center font-bold" id="domValue">0%</p>
</div>

<div class="glass p-5 rounded-2xl">
  <h3 class="font-semibold mb-1">Visual Similarity</h3>
  <p class="text-xs text-slate-400 mb-2">Layout & UI resemblance</p>
  <div class="progress-container"><div id="visualScore" class="progress-bar"></div></div>
  <p class="mt-2 text-center font-bold" id="visualValue">0%</p>
</div>

<div class="glass p-5 rounded-2xl border border-cyber-accent">
  <h3 class="font-semibold mb-1">Phishing Probability</h3>
  <p class="text-xs text-slate-400 mb-2">Rule-based hybrid score</p>
  <div class="progress-container"><div id="hybridScore" class="progress-bar"></div></div>
  <p class="mt-2 text-center font-bold" id="hybridValue">0%</p>
</div>

</div>

<!-- Chart -->
<div class="glass p-6 rounded-2xl">
  <canvas id="comparisonChart" height="130"></canvas>
</div>

<!-- Explanation -->
<div class="glass p-6 rounded-2xl space-y-3 text-sm text-slate-300">
  <h3 class="font-semibold text-slate-100">Decision Explanation</h3>
  <p id="explainUrl">• URL Score: —</p>
  <p id="explainDom">• DOM Similarity: —</p>
  <p id="explainVisual">• Visual Similarity: —</p>
  <p id="explainHybrid">• Hybrid Logic: —</p>
</div>

<!-- Final Verdict -->
<div class="glass p-8 rounded-2xl text-center border-2" id="resultCard">
  <h2 class="text-sm tracking-widest text-slate-400 mb-2">FINAL VERDICT</h2>
  <div id="finalLabel" class="text-4xl font-black">—</div>
</div>

</section>
</main>

<script>
let chart;

document.addEventListener("DOMContentLoaded", () => {
  const ctx = document.getElementById("comparisonChart").getContext("2d");
  chart = new Chart(ctx, {
    type: "bar",
    data: {
      labels: ["URL", "DOM", "Visual", "Hybrid"],
      datasets: [{
        data: [0,0,0,0],
        backgroundColor: ["#00f2ff","#7f00ff","#ff7d00","#00ff9d"],
        borderRadius: 12
      }]
    },
    options: {
      plugins:{ legend:{ display:false }},
      scales:{ y:{ beginAtZero:true, max:100 }}
    }
  });
});

urlForm.addEventListener("submit", async e => {
  e.preventDefault();

  analyzeBtn.textContent = "Analyzing...";
  analyzeBtn.disabled = true;

  try {
 const backendURL = "https://phishdetect-backend.onrender.com";

const res = await fetch(`${backendURL}/predict`, {
  method:"POST",
  headers:{ "Content-Type":"application/json" },
  body: JSON.stringify({ url: url.value })
});
    });

    const d = await res.json();

    const urlP = Math.round(d.url_score*100);
    const domP = Math.round(d.dom_score*100);
    const visP = Math.round(d.visual_score*100);
    const hybridP = Math.round(d.hybrid_score*100);

    results.classList.remove("hidden");
    detectedBrand.textContent = d.brand || "None";

    setBar("urlScore","urlValue",urlP);
    setBar("domScore","domValue",domP);
    setBar("visualScore","visualValue",visP);
    setBar("hybridScore","hybridValue",hybridP);

    chart.data.datasets[0].data = [urlP, domP, visP, hybridP];
    chart.options.scales.y.max = 100;
    chart.update("none");

    finalLabel.textContent = hybridP > 50 ? "PHISHING" : "LEGITIMATE";
    finalLabel.className = "";
    finalLabel.classList.add(
      hybridP > 50 ? "text-phish" : "text-legit",
      "text-4xl","font-black"
    );

    explainUrl.textContent =
      `• URL Score (${urlP}%): Suspicious patterns & lexical features`;
    explainDom.textContent =
      `• DOM Similarity (${domP}%): Structural similarity to known brand pages`;
    explainVisual.textContent =
      `• Visual Similarity (${visP}%): Layout & UI resemblance`;
    explainHybrid.textContent =
      `• Hybrid Logic: Rule-based fusion prioritizing domain legitimacy & similarity`;

  } catch {
    alert("Prediction failed. Backend not reachable.");
  }

  analyzeBtn.textContent = "Analyze";
  analyzeBtn.disabled = false;
});

function setBar(barId, textId, value){
  const bar = document.getElementById(barId);
  const text = document.getElementById(textId);
  bar.style.transition = "none";
  bar.style.width = "0%";
  void bar.offsetWidth;
  bar.style.transition = "width 1s ease";
  bar.style.width = value + "%";
  text.textContent = value + "%";
}
</script>

</body>
</html>
